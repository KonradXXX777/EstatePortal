@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dodaj Ogłoszenie - Sprzedaż</title>
    <link rel="stylesheet" href="~/css/SellOrRent/Sell/SellHouse.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=API_KEY&libraries=places"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Sprzedaż mieszkania</h1>
        </header>

        <form id="sellForm" class="form-container" oninput="updateProgress()" method="post" enctype="multipart/form-data">
            <!-- Informacje podstawowe -->
            <fieldset>
                <legend>Informacje podstawowe</legend>
                <label>Tytuł ogłoszenia <span class="required">*</span>
                    <input type="text" name="title" required>
                </label>
                <label>Powierzchnia użytkowa (m²)
                    <input type="number" name="usableArea">
                </label>
                <label>Cena <span class="required">*</span>
                    <input type="number" name="price" required>
                </label>
                <label>Cena za m² <span class="required">*</span>
                    <input type="number" name="pricePerMeter" required>
                </label>
                <label>Miejscowość <span class="required">*</span>
                    <input type="text" id="searchInput" name="location" required>
                </label>
                <label>Opis <span class="required">*</span>
                    <textarea name="description" rows="4" required></textarea>
                </label>
            </fieldset>

            <!-- Mapka -->
            <fieldset>
                <legend>Mapa</legend>
                <div id="map"></div>
            </fieldset>

            <!-- Parametry mieszkania -->
            <fieldset>
                <legend>Parametry mieszkania</legend>
                <label>Liczba pokoi
                    <input type="number" name="rooms">
                </label>
                <label>Piętro
                    <input type="number" name="floor">
                </label>
                <label>Liczba pięter w budynku
                    <input type="number" name="totalFloors">
                </label>
                <label>Winda
                    <select name="elevator">
                        <option value="">Wybierz</option>
                        <option value="yes">Tak</option>
                        <option value="no">Nie</option>
                    </select>
                </label>
                <label>Rok budowy
                    <input type="number" name="yearBuilt">
                </label>
                <label>Stan mieszkania
                    <select name="condition">
                        <option value="">Wybierz</option>
                        <option value="new">Nowe</option>
                        <option value="good">Dobry</option>
                        <option value="toRenovate">Do remontu</option>
                    </select>
                </label>
                <label>Miejsce parkingowe
                    <select name="parking">
                        <option value="">Wybierz</option>
                        <option value="yes">Tak</option>
                        <option value="no">Nie</option>
                    </select>
                </label>
                <label>Świadectwo energetyczne
                    <select name="energyCertificate">
                        <option value="">Wybierz</option>
                        <option value="yes">Tak</option>
                        <option value="no">Nie</option>
                    </select>
                </label>
                <label>Balkon
                    <select name="balcony">
                        <option value="">Wybierz</option>
                        <option value="yes">Tak</option>
                        <option value="no">Nie</option>
                    </select>
                </label>
                <label>Piwnica
                    <select name="basement">
                        <option value="">Wybierz</option>
                        <option value="yes">Tak</option>
                        <option value="no">Nie</option>
                    </select>
                </label>
                <label>Ogródek
                    <select name="garden">
                        <option value="">Wybierz</option>
                        <option value="yes">Tak</option>
                        <option value="no">Nie</option>
                    </select>
                </label>
                <label>Wyposażenie AGD
                    <select name="appliances">
                        <option value="">Wybierz</option>
                        <option value="yes">Tak</option>
                        <option value="no">Nie</option>
                    </select>
                </label>
                <label>Umeblowane
                    <select name="furnished">
                        <option value="">Wybierz</option>
                        <option value="yes">Tak</option>
                        <option value="no">Nie</option>
                    </select>
                </label>
            </fieldset>

            <!-- Zdjęcia -->
            <fieldset>
                <legend>Zdjęcia</legend>
                <div class="image-upload-grid">
                    <label class="upload-box">
                        <input type="file" name="images[]" multiple>
                        <span>Dodaj zdjęcie</span>
                    </label>
                </div>
            </fieldset>

            <button type="submit">Zatwierdź ogłoszenie</button>
        </form>
    </div>

    <script>
        function initMap() {
            const map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 52.409538, lng: 16.931992 },
                zoom: 13
            });

            const input = document.getElementById("searchInput");
            const autocomplete = new google.maps.places.Autocomplete(input);
            autocomplete.bindTo("bounds", map);

            const marker = new google.maps.Marker({
                map: map,
                anchorPoint: new google.maps.Point(0, -29)
            });

            autocomplete.addListener("place_changed", () => {
                const place = autocomplete.getPlace();

                if (!place.geometry || !place.geometry.location) {
                    alert("Nie znaleziono lokalizacji");
                    return;
                }

                map.setCenter(place.geometry.location);
                marker.setPosition(place.geometry.location);
            });
        }

        window.onload = initMap;

        function updateProgress() {
            const form = document.getElementById('sellForm');
            const inputs = Array.from(form.querySelectorAll('input, textarea, select'));
            const filled = inputs.filter(input => input.value.trim() !== '');
            const percentage = Math.round((filled.length / inputs.length) * 100);
            console.log(`${percentage}% completed`);
        }
    </script>
</body>
</html>
